<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.sand.min.css">
    <style>
        body { padding-bottom: 10rem; }
        h1 { font-size: 1.5rem; margin: .5rem 0 0 0; }
        h2 { display: none; }
        h3 { font-size: inherit; margin: 0 0 .5rem 0; }
        details summary { font-weight: bold; }
        details summary:hover { color: var(--pico-primary); }
        table { font-size: 80%; }
        td { vertical-align: top; }
        li { vertical-align: middle; }
        code { white-space: nowrap; }
        img.logo { width: auto; height: 150px; border-radius: 50%; }
        .flex { display: flex; flex-direction: row; flex-wrap: wrap; gap: 1rem; align-content: start; align-items: stretch; justify-content: start; }
        .flex div:last-child { margin-left: auto; }
    </style>

    <title>Data the Discord Bot</title>
</head>
<body>
    <header class="container">
        <div class="flex">
            <div><img class="logo" src="./data.png" alt="Data himself"></div>
            <div>
                <h1>Data the Discord Bot</h1>
                <a href="https://status.ourspace.ch/status/dardbot" target="_blank"><img src="https://status.ourspace.ch/api/badge/17/status" alt="dardbot status"></a>
            </div>
            <div><a href="https://vrc.group/THEDEN.1431" target="_blank"><img class="logo" src="./den-logo.png" alt="The DEN"></a></div>
        </div>
    </header>


    <main class="container">

        <details>
            <h2>Usage</h2>
            <summary>[ usage ]</summary>

            <p>To start type <code>/</code> in the message input box, and then look for Data's commands in the list that will pop-up.</p>
            <!-- <p><img src="./screenshot.png" alt="Commands list"></p> -->

            <p>On the left side of the commands list should be Data's avatar visible - click on it to show only his commands.</p>
            <!-- <p><img src="./screenshot.png" alt="Dedicated commands panel"></p> -->

            <p>Automatic documentation is provided once you start using a command. You can do so by either typing its slash command or click it in the list.</p>
            <!-- <p><img src="./screenshot.png" alt="Automatic documentation"></p> -->

            <p>Server admins can adjust the permission for each command in the server apps settings.</p>
            <!-- <p><img src="./screenshot.png" alt="Server app settings"></p> -->
        </details>


        <details>
            <h2>Commands</h2>
            <summary>[ commands ]</summary>
            <table>
                <thead>
                    <tr>
                        <th>Command</th>
                        <th>Options</th>
                        <th>Description</th>
                        <th>Response Visibility</th>
                    </tr>
                </thead>
                <tbody class="cmd_doc"></tbody>
            </table>
        </details>


        <details>
            <h2>Changelog</h2>
            <summary>[ changelog ]</summary>

            <p>We are on the road to the first final version. All feedback is welcome!</p>

            <h3>beta3.3 - 2024-01-21</h3>
            <ul>
                <li>Changed: <code>kticker</code> command response cosmetics.</li>
            </ul>

            <h3>beta3.2 - 2024-01-03</h3>
            <ul>
                <li>Changed: <code>music</code>, <code>qrcode</code>, <code>rhyme</code> and <code>time</code> responses are now only visible to the user that invoked the command. Reasoning was "to reduce bot spam".</li>
                <li>Added: <code>dice</code> command.</li>
            </ul>

            <h3>beta3.1 - 2024-11-28</h3>
            <ul>
                <li>Added: <code>kticker</code> command.</li>
            </ul>

            <h3>beta3 - 2024-11-24</h3>
            <ul>
                <li>Removed: <code>anto</code> command.</li>
                <li>Removed: <code>dict</code> command.</li>
                <li>Removed: <code>help</code> command.</li>
                <li>Removed: <code>syno</code> command.</li>
                <li>Removed: <code>tcmd</code> command.</li>
                <li>Changed: <code>sys</code> command renamed to <code>sysinfo</code>.</li>
                <li>Added: <code>echo</code> command.</li>
            </ul>

            <h3>beta2 - 2024-11-16</h3>
            <ul>
                <li>Removed: <code>animal</code> command.</li>
                <li>Changed: <code>music</code> command behaviour and arguments.</li>
                <li>Added: <code>anto</code> command.</li>
                <li>Added: <code>cat</code> command.</li>
                <li>Added: <code>qrcode</code> command.</li>
                <li>Added: <code>rhyme</code> command.</li>
                <li>Added: <code>syno</code> command.</li>
                <li>Added: <code>tcmd</code> command.</li>
            </ul>

            <h3>beta1  - 2024-11-06</h3>
            <ul>
                <li>Added: <code>animal</code> command.</li>
                <li>Added: <code>enigma</code> command.</li>
                <li>Added: <code>help</code> command.</li>
                <li>Added: <code>leet</code> command.</li>
                <li>Added: <code>music</code> command.</li>
                <li>Added: <code>quote</code> command.</li>
                <li>Added: <code>sys</code> command.</li>
                <li>Added: <code>time</code> command.</li>
            </ul>
        </details>


        <details>
            <h2>About</h2>
            <summary>[ about ]</summary>

            <p>
                Made by <a href="https://etrusci.org" target="_blank">arT2</a>
                for <a href="https://vrchat.com/home/user/usr_3519790d-ed85-4cd1-965e-ffb99ba003e0" target="_blank">FoxyFoo</a>
                and her circle.
            </p>
            <p>
                <strong>Privacy:</strong>
                The bot runs on a host rented and managed directly by arT2.
                No user data is shared with or sold to third parties.
                Currently the bot does not retain any history of conversations or activities.
                In the future, this may change if features like generating statistics or other enhancements are introduced; however, users will be informed.
                Although the source-code repository is not public, FoxyFoo has access to it.
            </p>
        </details>
    </main>


    <script>
        // @ts-check
        window.addEventListener('load', () => {
            fetch('./doc.json', { cache: 'no-cache' })
            .then(response => response.json())
            .then((data) => {
                // init_accordion()
                render_cmd_doc(data)
            })
            .catch(error => console.error('Boo:', error))
        })

        // const init_accordion = () => {
        //     const details = document.querySelectorAll('details')
        //     details.forEach((target) => {
        //         target.addEventListener('click', () => {
        //             details.forEach((detail) => {
        //                 if (detail !== target) {
        //                     detail.removeAttribute('open')
        //                 }
        //             })
        //             target.scrollIntoView()
        //         })
        //     })
        // }

        const render_cmd_doc = (data) => {
            const target = document.querySelector('.cmd_doc')

            for (const cmd_key in data.command) {
                const tr = document.createElement('tr')
                const td1 = document.createElement('td')
                const td2 = document.createElement('td')
                const td3 = document.createElement('td')
                const td4 = document.createElement('td')

                const opt = []
                for (const opt_key in data.command[cmd_key].option) {
                    opt.push(`<code>${opt_key}</code> ${data.command[cmd_key].option[opt_key]}`)
                }

                let tzlist_link = ``
                if (cmd_key == 'time') {
                    tzlist_link = `<br><a href="./timezones.txt">timezones.txt</a>`
                }

                let aplist_link = ``
                if (cmd_key == 'kticker') {
                    aplist_link = `<br><a href="./assetpairs.txt">assetpairs.txt</a>`
                }

                td1.innerHTML = `<code>/${cmd_key}</code>`
                td2.innerHTML = opt.join('<br>')
                td3.innerHTML = data.command[cmd_key].description + tzlist_link + aplist_link
                td4.innerHTML = `${data.command[cmd_key]['public_response'] ? 'Public' : 'Private'}`

                tr.append(td1, td2, td3, td4)

                target?.append(tr)
            }
        }
    </script>
</body>
</html>
